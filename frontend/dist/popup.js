document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("connection-status"),t=document.getElementById("connect-button"),n=document.getElementById("toggle-sidebar"),o=document.getElementById("upload-docs"),c=document.getElementById("create-outline");async function a(e){console.log("Sending message:",e);const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(t)try{const n=await chrome.tabs.sendMessage(t.id,e);console.log("Message response:",n)}catch(n){console.error("Error sending message:",n);try{await chrome.scripting.executeScript({target:{tabId:t.id},files:["content.js"]});const n=await chrome.tabs.sendMessage(t.id,e);console.log("Message response after injection:",n)}catch(e){console.error("Error injecting content script:",e)}}else console.error("No active tab found")}chrome.tabs.query({active:!0,currentWindow:!0},(t=>{const n=t[0]?.url?.startsWith("https://docs.google.com/document");e.textContent=n?"Connected":"Not connected",e.classList.toggle("connected",n)})),t.addEventListener("click",(async()=>{await a({action:"toggleSidebar",tab:"upload"}),window.close()})),n.addEventListener("click",(async()=>{await a({action:"toggleSidebar"})})),o.addEventListener("click",(async()=>{await a({action:"toggleSidebar",tab:"upload"})})),c.addEventListener("click",(async()=>{await a({action:"toggleSidebar",tab:"braindump"})})),chrome.runtime.onMessage.addListener(((t,n,o)=>(console.log("Received message in popup:",t),"connectionStatusChanged"===t.type&&(e.textContent=t.connected?"Connected":"Not connected",e.classList.toggle("connected",t.connected)),o({received:!0}),!0)))}));