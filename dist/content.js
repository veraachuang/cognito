(()=>{console.log("[Cognito] Content script initialized");let e=null,o=!1;function t(){const e=location.pathname.match(/\/document\/(?:u\/\d+\/)?d\/([^/]+)/)||location.pathname.match(/\/d\/([^/]+)/);return e&&e[1]||new URLSearchParams(location.search).get("id")||null}function n(e,o=3e3){document.querySelector(".cognito-toast")?.remove();const t=document.createElement("div");return t.className="cognito-toast",t.textContent=e,t.style.cssText="\n    position: fixed;\n    bottom: 20px;\n    left: 50%;\n    transform: translateX(-50%);\n    background-color: #333;\n    color: white;\n    padding: 10px 20px;\n    border-radius: 4px;\n    z-index: 10000;\n    font-family: 'Google Sans', Arial, sans-serif;\n  ",document.body.appendChild(t),o!==1/0&&setTimeout((()=>{t.style.opacity=0,t.style.transition="opacity 0.5s ease",setTimeout((()=>t.remove()),500)}),o),t}function i(t=null){e||e||(e=document.createElement("iframe"),e.src=chrome.runtime.getURL("frontend/sidebar.html"),e.id="cognito-sidebar",e.style.cssText="\n    position: fixed; top: 0; right: -350px;\n    width: 350px; height: 100vh;\n    border: none; z-index: 9999;\n    transition: right 0.3s ease;\n  ",document.body.appendChild(e)),o=!o,e.style.right=o?"0":"-350px",[".docs-editor-container",".docs-editor",".docs-content-wrapper"].map((e=>document.querySelector(e))).forEach((e=>{e&&(e.style.width=o?"calc(100% - 350px)":"100%",e.style.transition="width 0.3s ease")})),t&&o&&setTimeout((()=>{e?.contentWindow?.postMessage({action:"switchTab",tab:t},"*")}),300)}window.addEventListener("message",(o=>{if("sidebarReady"===o.data?.action&&e?.contentWindow&&e.contentWindow.postMessage({action:"docId",value:t()},"*"),"applyOutline"===o.data?.action&&o.source===e?.contentWindow){const e=o.data.docId||t(),i=o.data.outline;if(!i||!i.trim())return void alert("Error: Empty outline content received.");!function(e,o){if(!o)return void alert("Could not determine Google Doc ID. Please make sure you are in a Google Doc.");if(!e||!e.trim())return void alert("Error: Empty outline content.");const t=n("Inserting outline via Google Docs API...",6e4);console.log("[Cognito] Inserting outline directly into document:",o),console.log("[Cognito] Content length:",e.length),console.log("[Cognito] Content preview:",e.substring(0,100)+"..."),chrome.runtime.sendMessage({action:"insertOutlineWithAPI",docId:o,content:e},(e=>{if(t?.remove(),!e)return console.error("[Cognito] No response from background script"),void n("Error: No response from background script. Please try again.",5e3);if(e.success)n("Outline applied to document successfully!");else{const o=e.error||"Unknown error";console.error("[Cognito] Error applying outline:",o),n(`Error: ${o}. Please try again.`,5e3),e.details&&console.error("[Cognito] API Error details:",e.details)}}))}(i,e)}})),chrome.runtime.onMessage.addListener(((e,o,t)=>("toggleSidebar"===e.action?(i(e.tab),t({success:!0})):t({success:!1,error:"Unknown action"}),!0))),window.addEventListener("message",(o=>{o.source===e?.contentWindow&&"closeSidebar"===o.data?.action&&i()}))})();
//# sourceMappingURL=content.js.map