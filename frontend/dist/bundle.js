/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./sidebar.js":
/*!********************!*\
  !*** ./sidebar.js ***!
  \********************/
/***/ (() => {

eval("document.addEventListener('DOMContentLoaded', () => {\n  window.parent.postMessage({ action: \"sidebarReady\" }, \"*\");\n\n  const closeBtn = document.getElementById('close-sidebar');\n  const tabButtons = document.querySelectorAll('.tab-button');\n  const tabPanels = document.querySelectorAll('.tab-panel');\n  const braindumpInput = document.getElementById('braindump-input');\n\n  // === Tab Switching ===\n  closeBtn.addEventListener('click', () => {\n    window.parent.postMessage({ action: 'closeSidebar' }, '*');\n  });\n\n  tabButtons.forEach(button => {\n    button.addEventListener('click', () => {\n      const tabId = button.dataset.tab;\n      switchTab(tabId);\n    });\n  });\n\n  function switchTab(tabId) {\n    tabButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.tab === tabId));\n    tabPanels.forEach(panel => panel.classList.toggle('active', panel.id === tabId));\n  \n    const currentText = braindumpInput.value;\n  \n    if (tabId === 'braindump') {\n      analyzeText(currentText);\n    }\n  \n    if (tabId === 'analysis') {\n      analyzeForAnalysisTab(currentText); // âœ… this line ensures metrics update when Analysis is opened\n    }\n  }\n  \n\n  // === Brain Dump Text Input ===\n  braindumpInput.addEventListener('input', e => {\n    const text = e.target.value;\n    analyzeText(text);\n    analyzeForAnalysisTab(text);\n    localStorage.setItem('lastWritingUpdate', Date.now());\n  });\n\n  // === Listen for liveTextUpdate from content.js ===\n  window.addEventListener('message', (event) => {\n    const { source, action, data, features } = event.data;\n  \n    if (source === 'cognito-content' && action === 'liveTextUpdate') {\n      const activeTab = document.querySelector('.tab-button.active')?.dataset.tab;\n  \n      // Update brain dump tab if active\n      if (activeTab === 'braindump') {\n        braindumpInput.value = data;\n        analyzeText(data);\n      }\n  \n      // ALWAYS update analysis tab (even if it's not visible right now)\n      analyzeForAnalysisTab(data);\n  \n      // Update shared features (word count, time)\n      if (features) {\n        const wc = document.getElementById('word-count');\n        const rt = document.getElementById('reading-time');\n        if (wc) wc.textContent = features.wordCount;\n        if (rt) rt.textContent = features.readingTime;\n      }\n  \n      localStorage.setItem('lastWritingUpdate', Date.now());\n    }\n  });\n  \n  // === Brain Dump Analysis ===\n  function analyzeText(text) {\n    const wordCount = text.trim().split(/\\s+/).filter(Boolean).length;\n    const readingTime = Math.ceil(wordCount / 200);\n    const gradeLevel = calculateGradeLevel(text);\n    const writingStyle = analyzeWritingStyle(text);\n\n    document.getElementById('word-count').textContent = wordCount;\n    document.getElementById('reading-time').textContent = `${readingTime} min`;\n    document.getElementById('grade-level').textContent = gradeLevel;\n    document.getElementById('writing-style').textContent = writingStyle;\n\n    if (isWriterStuck(text)) {\n      generateWritingPrompts();\n    }\n  }\n\n  function calculateGradeLevel(text) {\n    const words = text.trim().split(/\\s+/).filter(Boolean);\n    const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);\n    const syllables = countSyllables(text);\n    return Math.round(0.39 * (words.length / Math.max(1, sentences.length)) + 11.8 * (syllables / Math.max(1, words.length)) - 15.59);\n  }\n\n  function countSyllables(text) {\n    const words = text.trim().toLowerCase().split(/\\s+/);\n    return words.reduce((count, word) => {\n      word = word.replace(/[^a-z]/g, '');\n      return count + (word.length <= 3 ? 1 : word.replace(/[^aeiouy]+/g, ' ').trim().split(/\\s+/).length);\n    }, 0);\n  }\n\n  function analyzeWritingStyle(text) {\n    const words = text.trim().split(/\\s+/).filter(Boolean);\n    const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);\n    const avgWordLength = words.reduce((sum, w) => sum + w.length, 0) / Math.max(1, words.length);\n    const avgSentenceLength = words.length / Math.max(1, sentences.length);\n\n    if (avgWordLength > 5 && avgSentenceLength > 20) return 'Academic';\n    if (avgWordLength < 4 && avgSentenceLength < 15) return 'Conversational';\n    return 'Balanced';\n  }\n\n  function isWriterStuck(text) {\n    const words = text.trim().split(/\\s+/);\n    const uniqueWords = new Set(words.slice(-10));\n    const lastUpdate = localStorage.getItem('lastWritingUpdate');\n    return uniqueWords.size < 5 || (lastUpdate && Date.now() - lastUpdate > 30000);\n  }\n\n  function generateWritingPrompts() {\n    const prompts = [\n      'What is the main point you want to convey?',\n      'How does this connect to your previous ideas?',\n      'Can you provide an example to illustrate this?',\n      'What would someone who disagrees with you say?',\n      'How does this relate to your overall topic?'\n    ];\n    const container = document.getElementById('prompts-container');\n    if (!container) return;\n\n    container.innerHTML = '';\n    prompts.forEach(prompt => {\n      const div = document.createElement('div');\n      div.className = 'prompt';\n      div.textContent = prompt;\n      div.onclick = () => {\n        braindumpInput.value += `\\n\\n${prompt}`;\n        braindumpInput.focus();\n      };\n      container.appendChild(div);\n    });\n  }\n\n  // === Analysis Tab Update ===\n  function analyzeForAnalysisTab(text) {\n    const words = text.trim().split(/\\s+/).filter(Boolean);\n    const longWords = words.filter(w => w.length > 7);\n    const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);\n\n    const vocabRatio = longWords.length / Math.max(1, words.length);\n    const vocabLevel =\n      vocabRatio > 0.2 ? 'Advanced' :\n      vocabRatio > 0.1 ? 'Moderate' :\n      'Basic';\n\n    const avgSentenceLength = words.length / Math.max(1, sentences.length);\n    const sentenceStructure =\n      avgSentenceLength > 20 ? 'Complex' :\n      avgSentenceLength > 12 ? 'Varied' :\n      'Simple';\n\n    const clarityScore = Math.max(50, Math.min(100, 120 - avgSentenceLength * 2));\n\n    const vividWords = ['exciting', 'surprising', 'dramatic', 'incredible', 'unexpected', 'strange', 'intense'];\n    const engagementCount = words.filter(w => vividWords.includes(w.toLowerCase())).length;\n    const engagementScore = Math.min(100, 70 + engagementCount * 3);\n\n    document.getElementById('vocabulary-level').textContent = vocabLevel;\n    document.getElementById('sentence-structure').textContent = sentenceStructure;\n    document.getElementById('clarity-score').textContent = `${Math.round(clarityScore)}%`;\n    document.getElementById('engagement-score').textContent = `${engagementScore}%`;\n\n    document.getElementById('recommendations-container').innerHTML = `\n      <ul>\n        <li>Use more vivid and specific vocabulary.</li>\n        <li>Vary sentence structure for better rhythm.</li>\n        <li>Simplify long or complex sentences.</li>\n      </ul>\n    `;\n  }\n});\n\n//# sourceURL=webpack://cognito-extension/./sidebar.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./sidebar.js"]();
/******/ 	
/******/ })()
;